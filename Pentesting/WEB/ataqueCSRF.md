<p align="center">
  <a href="https://github.com/DenverCoder1/readme-typing-svg"><img src="https://readme-typing-svg.herokuapp.com?font=Fira+Code&pause=1000&color=D1F700&width=405&lines=Explotar+vulnerabilidad+CSRF"></a>
</p>

<h1 align="center"></h1>

<h3 align="center"><ins>VULNERABILIDAD CSRF | Cross-site Request Forgery |</ins></h3>

La vulnerabilidad CSRF (falsificación de petición en sitios cruzados) ocurre en aplicaciones web y permite a los atacantes realizar acciones a nombre de usuarios legítimos que se encuentran desprevenidos, explotando así sus sesiones autenticadas. El ataque suele ir acompañado con técnicas de ingeniería social dado que el usuario debe estar conectado a la plataforma para que éste visite el enlace malicioso.

### Requisitos previos para un Ataque CSRF
Para explotar una vulnerabilidad CSRF (Cross-Site Request Forgery), deben cumplirse varias condiciones esenciales:

- `Identificar una Acción Valiosa`: El atacante debe encontrar una acción en la aplicación web que tenga valor y pueda ser explotada.
Las acciones valiosas incluyen:

- `Cambiar la Contraseña`: Modificar la contraseña del usuario para que el atacante pueda tomar el control de la cuenta.

- `Cambiar el Correo Electrónico`: Actualizar la dirección de correo electrónico del usuario, permitiendo que el atacante reciba futuras comunicaciones o reinicios de contraseña.

- `Elevar Privilegios`: Incrementar el nivel de acceso de una cuenta para obtener mayores permisos dentro del sistema.

-  `Realizar Transferencias Financieras`: En aplicaciones bancarias, realizar transferencias de dinero no autorizadas.

**En resumen:**

> Para que un ataque CSRF sea posible, el atacante debe encontrar una acción valiosa que explotar, asegurarse de que la sesión del usuario se gestione a través de cookies o autenticación básica HTTP, y verificar que la solicitud no contenga parámetros impredecibles que podrían invalidar el intento de ataque.

<p align="center">
  <img src="https://github.com/R3LI4NT/articulos/blob/main/Pentesting/WEB/img/ataqueCSRF.png">
</p>

<h1 align="center"></h1>

### EXPLOTAR CSRF | Login
En el siguiente ejemplo, les mostraré cómo explotar la vulnerabilidad CSRF en una sesión, para ello elegí la máquina <a href="https://github.com/R3LI4NT/ctf-retos/blob/main/1-%20Maquinas-Easy/Metasploitable_2.md">Metasploitable 2</a> con víctima.

Supongamos que queremos cambiar la contraseña de nuestra cuenta desde la configuración del sitio web, para ello existen dos métodos de petición para ejecutar la acción.

- `Método GET`: Se utiliza para pedir información al servidor, los datos son enviados de forma visible en la URL.

Por ejemplo:
```
http://www.myweb.com/action.php?nombre=wilson&apellidos1=smith
```

- `Método POST`: Se utiliza para subir un archivo o loguearse en el sitio web, los datos son enviados de forma codificada (no visible); siendo está la más segura.

Por ejemplo:
```
http://www.myweb.com/action.php
```

![1](https://github.com/R3LI4NT/articulos/assets/75953873/cb94e897-6175-46db-b9c8-0a7519fae0b7)

Con la herramienta Burp Suite lo que haremos es configurar un Proxy e interceptar la petición y modificarla. Para ello, debemos de ir a la `configuración` de nuestro navegador **>** `Newtork Settings` y copiar lo siguiente:

| Manual Proxy | Valor |
| ------------- | ------------- |
| HTTP Proxy | 127.0.0.1  |
| Port  | 8080 |

![2](https://github.com/R3LI4NT/articulos/assets/75953873/3e971371-726f-48c8-a793-bd5ef075f9c9)

En la pestaña de `Proxy` de Burp Suite tienen que tener estos valores configurado (por defecto) **>** `ProxySettings`.

![3](https://github.com/R3LI4NT/articulos/assets/75953873/5d1a8f91-f21e-4dfb-9431-55dfaacce3c9)

El `Intercep` debe estar activado (ON). Ahora, si tratamos de cambiar nuevamente nuestra contraseña:

![4](https://github.com/R3LI4NT/articulos/assets/75953873/6cbc63db-6f28-40dd-9220-b825cd061306)

La petición es interceptada pero sale en método POST ¿cómo es posible cambiarla a método GET?, es tan fácil como `seleccionar la petición` **>** clic derecho y `Change method request`.

![5](https://github.com/R3LI4NT/articulos/assets/75953873/b332267d-f2e5-431e-a45c-347fdc84f1bb)


