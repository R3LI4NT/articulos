<p align="center">
  <a href="https://github.com/DenverCoder1/readme-typing-svg"><img src="https://readme-typing-svg.herokuapp.com?font=Fira+Code&pause=1000&color=008FFF&width=250&lines=Fases+de+un+Pentest"></a>
</p>

<h1 align="center"></h1>

<h3 align="center"><ins>¿CUÁLES SON LAS FASES DE UN PENTEST?</ins></h3>

Cuando hablamos de Pentesting o Hacking Ético nos estamos refiriendo a ciberataques que funcionan como simulaciones contra un sistema software, servidor o incluso contra una persona en particular (ingeniería social). La prueba de pentesing son necesarias para prevenir vulnerabilidades de ataques externos y así verificar que los sistemas están funcionando correctamente. Por ejemplo, supongamos que soy contratado para simular un robo en una mansión, yo como presunto ladrón debo de infiltrarme dentro de la vivienda y revisar cada una de las habitaciones hasta descubrir cómo está todo distribuido, hasta las cajas fuerte que nadie sabia excepto tú.

Estos test de intrusión actúan bajo el margen de la ley, es decir, son totalmente legales ya que son pactados entre la entidad u organización que solicita el servicio. Es crucial tener en cuenta que, durante una evaluación de intrusión, un pentester debe respetar ciertos límites. Si se le asigna la tarea específica de auditar exclusivamente las redes de la empresa, no debería extender su análisis al servidor web, ya que no fue contratado para realizar esa tarea.

Entre las tácticas de intrusión más comunes empleadas por los atacantes, se encuentran:

- Despliegue de Malware, virus, troyanos o keyloggers.
- Aprovechamiento de puertas traseras.
- Ingreso a sistemas mediante la explotación de configuraciones deficientes.
- Empleo de técnicas de ingeniería social para infiltrar archivos no deseados o robar credenciales a través de técnicas como el phishing.

<p align="center">
  <img src="https://github.com/R3LI4NT/articulos/blob/main/Ciberseguridad/Reportes_Informes/GNU-Linux/img/fases_pentest.png">
</p>

<h1 align="center"></h1>


A continuación explicaré cómo  es el proceso de un examen de penetración junto con sus fases. Cabe recalcar que estas fases tienen un orden específico pero que los nombres pueden variar. Mientras explico fase por fase, descargué una máquina vulnerable llamada <a href="https://www.vulnhub.com/entry/sectalks-bne0x03-simple,141/">**SECTALKS**</a> de VulnHub para describir el proceso de las fases y observar algunas vulnerabilidades ya explotadas en mis artículos.

![1](https://github.com/R3LI4NT/articulos/assets/75953873/ebf3505d-7c30-4969-a409-efebf4556dce)

### [1] RECONOCIMIENTO

En esta primera fase se definen los objetivos del Pentesting para determinar que métodos se van a emplear. El auditor/pentester hace una recolección de todos los datos que se encuentren disponibles del objetivo para el test de penetración. Según el caso, algunos de estos datos suelen ser:

- Direcciones IP, puertos abiertos, servicios corriendo, dominios.

- Google Hacking (<a href="https://github.com/R3LI4NT/articulos/blob/main/Pentesting/ING-SOCIAL/Doxing_OSINT.md">dorking</a>).

- Herramientas de scraping (DNS-Recon, Nmap, SkipFish, Maltego, etc).

- Ingeniería Social: En caso de llevar una práctica de ingeniería social a los empleados de una empresa, se puede considerar prácticas como el phishing y/o spoofing de manera autorizada. Esto con el objetivo de capacitar a los empleados contra este ataque habitual.

- Obtención de metadados mediante documentos, videos y fotografías.

Lo primero que haré es encontrar la dirección privada de la máquina objetivo, para ello tenemos diversas herramientas como nmap, arp-scan o netdiscover.

```
sudo arp-scan -I eth0 --localnet
```

![2](https://github.com/R3LI4NT/articulos/assets/75953873/27bbeeb6-ee38-489b-98a4-681d69620496)

El comando `ping` se suele encontrar en cualquier sistema y su utilidad consiste en probar la conectividad de red. Con el siguiente comando sabremos si la máquina víctima se encuentra activa al enviar tres paquetes:

```
ping -c 3 192.168.25.135
```

![3](https://github.com/R3LI4NT/articulos/assets/75953873/669edae0-657b-4eb9-b88a-21f75416f775)

**DATO IMPORTANTE:** A través de los valores TTLs podemos averiguar el sistema operativo por detrás de esa IP.

| O.S | TTL|
| ------------- | ------------- |
| Linux/Unix | 64 |
| Windows | 128 |
| MacOS | 64 |
| Solaris/AIX |  254 |
| FreeBSD | 64 |

Una vez comprobemos su actividad, con la herramienta de Nmap escaneamos todos los puertos abiertos:

```
nmap -p- --open -sC -n -Pn -vvv 192.168.25.135
```

- **-p-**: Va a escanear todos los puertos (del 1 hasta 65536).

- **--open**: Solo va a escanear aquellos que se encuentren abiertos.

- **-sC**: Ejecuta scripts predeterminados de Nmap en busca de información del sistema operativo sin causar interrupciones.

- **-n**: Deshabilita la resolución de DNS durante el escaneo, es decir, si encuentra un puerto abierto lo mostrará en pantalla sin necesidad de esperar a que termine el escaneo por completo para listar todos los puertos abiertos.

- **-Pn**: Nmap omite la comprobación del host, al incluir esta opción le indicas que ya asumes que el host se encuentra activo. Permite ahorrarnos tiempo durante el escaneo.

- **-vvv**: El modo verbose mostrará información adicional durante la salida del escaneo. 

![4](https://github.com/R3LI4NT/articulos/assets/75953873/3ec1aefa-853c-4b45-bc01-6ccf43118547)

Como pueden observar, el puerto 80 es el único que se encuentra abierto, lo que supone que existe un servicio web corriendo por detrás. Para ello, utilizaremos el siguiente comando para listar las versiones de los servicios disponibles:

```
nmap -p 80 -sV 192.168.25.135
```

- **-p 80**: Aquí le específicamos a Nmap que únicamente nos muestre información del puerto 80, se debe separar con coma "," si desean especificarle más puertos (Ej: nmap -p 80,21,20,443).

- **-sV**: Realiza un escaneo de las versiones de los servicios descubiertos.

![5](https://github.com/R3LI4NT/articulos/assets/75953873/2e34a50e-579d-4487-b225-0ca2f3b406ec)


### [2] ENUMERACIÓN Y ANÁLISIS DE VULNERABILIDADES

En esta segunda fase se realiza todas las acciones posibles que nos permitan comprometer nuestro objetivo, suele ir acompañada con la primera fase. A partir de una lista de vulnerabilidades conocidas (<a href="https://owasp.org/www-project-top-ten/">como OWASP Top 10</a>), un pentester o hacker ético debe investigar que tipo de exploits existen para obtener acceso al sistema, pero eso ya sería apresurarnos a la tercera fase. 

Algunas de las vulnerabilidades más comunes son las siguientes:

- Inyección (SQL, HTML, etc).

- Fallos Criptográficos.

- Mala configuración de seguridad (LFI, RFI, XSS, etc).

- Fallos de identificación y autenticación de usuario.

- Componentes obsoletos (Ej: versiones antiguas de plugins WordPress).

Al ingresar al sitio web nos encontramos con un panel de login, un dato importante es siempre registrarse para obtener más funcionalidades dentro del sitio.

![6](https://github.com/R3LI4NT/articulos/assets/75953873/934b2101-38ad-4a24-986d-eb6d82ae9eef)

![7](https://github.com/R3LI4NT/articulos/assets/75953873/9e768940-2162-46a1-b7d8-dcf7a5090b8e)

En las configuraciones del usuario tenemos la posibilidad de cambiar nuestro avatar, a simple vista puede pasar desapercibido para el administrador o el propio usuario, pero para un atacante es una oportunidad para sus travesuras. Existe una vulnerabilidad (explicada en un artículo) llamada "<a href="https://github.com/R3LI4NT/articulos/blob/main/Pentesting/WEB/fileUpload.md">**_File Upload_**"</a> y consiste en subir un archivo al servidor web sin que sea comprobado por algun sistema de seguridad en particular. Al ser un avatar debe ser un archivo con extensión .jpg, .gif o .png; pero para explotar esta vulnerabilidad el atacante sube un archivo (generalmente una reverse shell) con extensión .php para poder recargarla al servidor web y ganar acceso.

En esta fase no fue necesario utilizar alguna herramienta para escanear vulnerabilidades ya que fue a "ojo" dado que es una máquina preparada, pero perfectamente podríamos estar frente a SQLi, XSS, LFI, etc. Aún así, dejaré algunas herramientas que pueden utilizar para escanear vulnerabilidades:

- Nmap

- ZenMAP

- Nessus

- Uniscan

- Burp Suite

- Nikto

- SQLmap

- Legion

- WPScan

- W3af

- Skipfish

Y para la vulnerabilidad de File Upload existe un repositorio útil que pueden utilizar en sus prácticas de pentesting:

**Fuxploider**: https://github.com/almandin/fuxploider

### [3] EXPLOTACIÓN DE VULNERABILIDADES


En proceso...
