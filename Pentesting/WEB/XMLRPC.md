<p align="center">
  <a href="https://github.com/DenverCoder1/readme-typing-svg"><img src="https://readme-typing-svg.herokuapp.com?font=Fira+Code&pause=1000&color=D1F700&width=410&lines=Vulnerabilidad+XMLRPC+en+WordPress"></a>
</p>

<h1 align="center"></h1>

<h3 align="center"><ins>¿Qué es el archivo XML-RPC.php?</ins></h3>

El archivo `xml-rpc.php` (Remote Procedure Call, o llamada a procedimiento remoto en XML) es un componente que permite interactuar de forma remota con un sitio web de WordPress mediante el protocolo XML-RPC, permitiendo así realizar diferentes operaciones. 

Entre estas funciones permite:

- **Publicación remota**: Permite a los usuarios publicar contenido en su sitio de WordPress desde aplicaciones externas.

- **Gestión de Contenidos**: Se pueden realizar tareas como editar y eliminar publicaciones, gestionar comentarios y categorías, entre otras.

- **Compatibilidad**: Facilita la integración con otros servicios web y aplicaciones que utilizan el protocolo XML-RPC.


<p align="center">
  <img src="https://github.com/R3LI4NT/articulos/blob/main/Pentesting/WEB/img/XML-RPC.png">
</p>

<h1 align="center"></h1>

</br>

### | Detectar y Explotar XML-RPC

En el siguiente ejemplo voy a utilizar la máquina <a href="https://github.com/R3LI4NT/ctf-retos/blob/main/2-%20Maquinas-Medium/Mr.Robot_1.md">Mr. Robot1</a> para mostrarles el método de detección y explotación de XML-RPC. Como experiencia personal, en entornos reales está vulnerabilidad suele ocurrir frecuentemente.

Por seguridad, siempre que descarguen una máquina de Vulnhub asegúrese de comprobar la salida del hash y compararla con el repositorio oficial. Esto garantizará la integridad del archivo.

```
Get-FileHash -Algorithm MD5 .\mrRobot.ova
```

![1](https://github.com/user-attachments/assets/8e858ad7-c3c3-4912-a2c3-5df728963817)

Una de las formas más fácil de saber si el archivo XML-RPC se encuentra disponible es haciendo uso de WPScan.
```
wpscan --url http://example.com
```

![2](https://github.com/user-attachments/assets/611ff604-2a43-4400-bb1f-415c7f1367b8)

O el método más simple, realizar un fuzzing pero aplicando un filtro con archivos "**.php**".
```
dirb http://example.com /usr/share/wordlists/dirb/common.txt -X '.php'
```

![3](https://github.com/user-attachments/assets/c489150c-fbd4-45cf-a20a-9270cb2aa53e)


Si accedemos al archivo del navegador podemos ver que solamente acepta peticiones a través del método POST.

![4](https://github.com/user-attachments/assets/3722b738-a792-417c-a798-4fbaf1b648b5)

Con el comando curl podemos enviar una petición mediante POST:
```
curl -X POST http://example.com/xmlrpc.php
```

![5](https://github.com/user-attachments/assets/032d29e7-cc90-443f-8594-35ca1275972c)

Soy un usuario que le gusta mucho manejar la terminal antes que cualquier interfaz gráfica, pero cuando se trata de aplicaciones web es indispensable usar Burp para estas pruebas.

![6](https://github.com/user-attachments/assets/58e75750-a8a9-4822-9973-fe1c51468b14)




