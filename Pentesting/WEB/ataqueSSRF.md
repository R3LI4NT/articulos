<p align="center">
  <a href="https://github.com/DenverCoder1/readme-typing-svg"><img src="https://readme-typing-svg.herokuapp.com?font=Fira+Code&pause=1000&color=D1F700&width=400&lines=Explotar+vulnerabilidad+SSRF"></a>
</p>

<h1 align="center"></h1>

<h3 align="center"><ins>VULNERABILIDAD SSRF | Server-side Request Forgery  |</ins></h3>

La vulnerabilidad SSRF (Server-Side Request Forgery) ocurre en aplicaciones web cuando un atacante puede manipular el servidor para realizar solicitudes a otros servidores internos o externos, a menudo con privilegios que el atacante no tiene. Este tipo de ataque puede llevar a la exposición de información interna, escaneo de puertos internos, y en algunos casos, ejecución de comandos en el servidor.

### Requisitos previos para un Ataque SSRF
Para explotar una vulnerabilidad SSRF (Server-Side Request Forgery), deben cumplirse varias condiciones esenciales:

- `Encontrar un punto de entrada`: El atacante debe identificar una funcionalidad en la aplicación que permita enviar solicitudes a ubicaciones específicas. Ejemplos incluyen formularios de carga de URL, servicios de obtención de recursos remotos, o API que procesan URLs suministradas por el usuario.

- `Entender el contexto de la solicitud`: El atacante debe comprender cómo se manejan y procesan las solicitudes en el servidor, incluyendo cabeceras, métodos HTTP, y cualquier mecanismo de autenticación.

- `Acceso a recursos iternos`: En muchos casos, los ataques SSRF son efectivos porque el servidor tiene acceso a recursos internos que no son directamente accesibles desde el exterior. Estos pueden incluir servicios internos, bases de datos, o incluso sistemas de administración interna.

### Ejemplos de Acciones Maliciosas mediante SSRF

- `Exfiltración de datos`: Obtener datos sensibles almacenados en servidores internos, como configuraciones de bases de datos, credenciales, o información privada de usuarios.

- `Escaneo de puertos`: Utilizar la capacidad del servidor para escanear la red interna y descubrir servicios que están en ejecución, potencialmente exponiendo vulnerabilidades adicionales.

- `Desencadenar acciones en otros servicios`: Enviar solicitudes que desencadenen acciones en otros servicios internos, como iniciar procesos, modificar datos, o incluso ejecutar comandos.

- `Acceso a metadatos de nube`: En entornos de nube, los ataques SSRF pueden ser utilizados para acceder a metadatos de instancia, permitiendo la obtención de credenciales y otra información crítica.

**En resumen:**

> Para que un ataque SSRF sea posible, el atacante debe identificar un punto de entrada que permita el envío de solicitudes, comprender el contexto de cómo se manejan estas solicitudes en el servidor, y apuntar a recursos internos o sensibles que pueden ser explotados a través de la capacidad del servidor para comunicarse con otros sistemas.

<p align="center">
  <img src="https://github.com/R3LI4NT/articulos/blob/main/Pentesting/WEB/img/ataqueSSRF.png">
</p>

### Resumen del Proceso:

- 1)- El atacante envía una solicitud maliciosa al servidor público.
  
- 2)- El servidor público procesa la solicitud y extrae la URL interna.
  
- 3)- El servidor público envía una solicitud a la URL interna en la red interna.
  
- 4)- El servidor en la red interna responde con el contenido solicitado.
  
- 5)- El servidor público reenvía la respuesta al atacante, quien recibe la información sensible del servidor interno.

Este esquema muestra cómo una vulnerabilidad SSRF permite a un atacante acceder a recursos internos a través de un servidor público que actúa como intermediario.


<h1 align="center"></h1>

### EXPLOTAR SSRF | Burp Suite

En el siguiente ejemplo, utilizaré los laboratorios de PortSwigger para explotar la vulnerabilidad SSRF mediante la herramienta Burp Suite. Estos laboratorios son gratuitos y solo requieren la creación de una cuenta: https://portswigger.net/web-security/ssrf.

![1](https://github.com/user-attachments/assets/6fc35338-b605-4b1a-9a94-659b7f4d1a57)

El primer laboratorio nos explica que tiene una función para comprobar el stock de un producto, el cual hace una petición al sistema interno. Para resolverlo tenemos que cambiar la URL de la comprobación del stock para acceder al panel de administración y eliminar el usuario `Carlos`.

Lo primero será configurar un servidor proxy para que registre todo el tráfico que se genere en el navegador web, para ello debemos ejecutar Burp Suite e ir a la pestaña de `Proxy` -> `Options` y verificar si tenemos el proxy como se muestra a continuación:

![186309125-51ad97c3-b823-4825-8bc4-43fb74091e88](https://github.com/user-attachments/assets/b2815890-a475-45db-91fe-2a91aa1bea50)

Luego en el navegador, por ejemplo Firefox ir a `Preferencias` -> `Avanzadas` -> `Proxy de Red` -> `Configuración` -> `Configuración Manual del Proxy`

En Proxy HTTP escribir `127.0.0.1`, en Puerto escribir `8080` y tildar el mismo proxy para todo:

![186309874-aa443078-e385-45dd-bbb0-faca9508e320](https://github.com/user-attachments/assets/6bff1037-47f8-4d6b-86a8-f41743fb2370)

Ahora lo que haremos es meternos en cualquier producto.

![2](https://github.com/user-attachments/assets/1ab0b753-0938-4fb9-b34c-6baf771465d1)

Buscamos la función de stock y pulsamos en ella.

![3](https://github.com/user-attachments/assets/9d127d7a-66f7-4c8e-ad21-c2dab40f44dd)
